# <img src="https://julianodb.github.io/SISTEMAS_ELECTRONICOS_PARA_INGENIERIA_BIOMEDICA/img/logo_fing.png?raw=true" align="right" height="45"> Trabajo 2 de Sistemas Electrónicos

#### Primer Semestre de 2025

## Introducción

Este semestre, su grupo es responsable de diseñar y fabricar un prototipo de fotopletismógrafo para aplicar los conocimientos y tecnicas relacionados a la asignatura de Sistemas Electrónicos.

A grandes rasgos, el prototipo debe tener las siguientes funcionalidades:

1. medir la frecuencia cardíaca (Heart Rate - HR)
1. emitir una señal de luz infrarroja cuando hay un pulso cardíaco
1. detectar la señal infraroja emitida por otro prototipo
1. medir el tiempo entre la detección de la señal infrarroja y el siguiente pulso cardíaco (Pulse Transit Time - PTT)
1. Permitir la visualización de los valores de HR y PTT medidos

El sistema que deben diseñar puede ser dividido en los siguientes bloques:

![TX](../img/TX.png)

Figura 1: División del sistema del fotopletismógrafo en bloques

En el segundo trabajo, los objetivos son los siguientes:

1. diseñar el driver del LED que indica cuando hay un pulso.
1. diseñar el driver del emisor de señal infrarroja.
1. proyectar un circuito de Latch SR, que se usará para medir el PTT

El trabajo será un ensayo que debe contener la siguiente información:

- Identificación del grupo (color)
- Identificación de los integrantes del grupo (nombres, apellidos y RUT)
- La información que se pide en cada una de las siguientes sesiones de este documento

## 1. Driver del LED indicador de pulso

En el trabajo anterior se eligió el valor de la resistencia $R_{2}$ para que el LED se encienda cuando el siguiente circuito se alimenta con +5V:

<img src="https://julianodb.github.io/electronic_circuits_diagrams/resistance_led_5.png" width="70">

Figura 2: Circuito de la indicación luminosa de pulso

En este trabajo, se introduce un transistor para permitir controlar cuando el LED se enciende y se apaga:

<!--img src="https://julianodb.github.io/electronic_circuits_diagrams/resistance_led_5.png" width="70"-->

Figura 3: Driver del LED indicador de pulso

El objetivo es que el LED se encienda cuando $V_i=5\ V$, y se apague cuando $V_i=0\ V$.

1. Considerando que $V_{CE_{SAT}} = 0.3\ V$, $V_{BE_{SAT}} = 0.7\ V$ y $\beta=100$, elijan un valor de $R_4$ dentro de los valores disponibles en el anexo de tal forma que cuando $V_i=5\ V$, el transistor está en modo saturado con $\beta_{forzado} \approx 10$. (1.5pt)


## 2. Driver del emisor de señal infrarroja

En el trabajo anterior se eligió el valor de la resistencia $R_{3}$ para que los LEDs infrarrojos se enciendan cuando el siguiente circuito se alimenta con +5V:

<img src="https://julianodb.github.io/electronic_circuits_diagrams/resistance_3_led.png" width="70">

Figura 4: Circuito del emisor de señal infrarroja

En este trabajo, se introduce un transistor para permitir controlar cuando la señal infrarroja se enciende y se apaga:

<!--img src="https://julianodb.github.io/electronic_circuits_diagrams/resistance_3_led.png" width="70"-->

Figura 5: Driver del emisor de señal infrarroja

El objetivo es que los LEDs se enciendan cuando $V_i=5\ V$, y se apaguen cuando $V_i=0\ V$.

2. Considerando que $V_{CE_{SAT}} = 0.3\ V$, $V_{BE_{SAT}} = 0.7\ V$ y $\beta=100$, elijan un valor de $R_5$ dentro de los valores disponibles en el anexo de tal forma que cuando $V_i=5\ V$, el transistor está en modo saturado con $\beta_{forzado} \approx 10$. (1.5pt)

## 3. Latch SR

Para medir el PTT, primero es necesario generar una señal eléctrica que depende del PTT de alguna forma. La estrategia que adoptaremos es ... Cuando el primer dispositivo detecta un pulso cardiaco, la señal de PTT debe subir, y cuando el segundo dispositivo detecta el pulso, la señal debe bajar. de esta forma generamos pulsos de voltaje cuya duración es igual al PTT, conforme la imagen a continacion:

Figura 6: Señal de pulsos con duración igual al PTT

Para implementar la estrategia seleccionada, se necesita un circuito que tiene dos entradas: cuando una de las entradas se activa, el voltaje de salida sube, y cuando la otra entrada se activa, el voltaje de salida baja. Un circuito que implementa dicha funcionalidad se conoce como Latch SR (Done SR son las iniciales de Set y Reset).

Para implementar el Latch SR, empezamos con el siguiente circuito:

Q3 R6 R9

Figura 7: Inversor

3. Elijan R6 de tal forma que I \approx 1\ mA cuando Q3 está saturado. (1pt)
4. Elijan R9 de tal forma que \beta_{forzado} \approx 10 cuando V9 = 5\ V. (1pt)

La idea es que el circuito funcione solamente con dos posibles entradas: 0 y 5 V. Cuando la entrada es 0 V, Q3 está apagado y el voltaje V6 es, por lo tanto 5V. Por otro lado, cuando la entrada es 5V, Q3 está saturado y la salida es, por lo tanto approx 0 V. Es decir, el circuito de cierta forma "invierte" la entrada.

En el siguiente paso, conectamos una copia del circuito a la salida del primero:

Q3 R6 R9 R8 Q4 R7

Figura 8: Doble inversor

El resultado es que la entrada se "invierte" dos veces, lo que significa que ahora el voltaje V7 sigue la entrada: si Vi = 5 V, V7 = 5 V y si Vi = 0 V, Vo \approx 0 V. Ademas, notese que ambos transistores siempre están en estados opuestos: si Q3 está saturado, Q4 está apagado, y si Q3 está apagado, Q4 está saturado.

En el siguiente paso, conectamos la salida del circuito a su entrada, de tal forma que ya no se necesita Vi para mantener el circuito en uno de sus dos estados. El circuito resultante se va a mantener o encendido (Q3 saturado y Q4 apagado) o apagado (Q3 apagado y Q4 saturado) de forma indefinida.

Figura 9: Latch

Finalmente, introducimos dos transistores que permiten elegir en cual estado queremos mantener el circuito. Tanto Q5 y Q6 se mantendrán apagados la mayor parte del tiempo, y encenderemos apenas uno de ellos a la vez por un breve periodo de tiempo para configurar el circuito. Cuando activamos Q5, la base de Q3 se conecta a tierra, lo que lo apaga y, por lo tanto satura Q4. Ahora, Q3 se mantendrá apagado y Q4 saturado incluso si apagamos Q5. Por otro lado, cuando activamos Q6, Q4 se apaga, lo que satura Q3. Ahora, Q3 se mantendrá saturado y Q4 apagado incluso cuando apagamos Q6. Así, se ha implementado un Latch SR.

Figura 10: Latch SR

5. Elijan el valor de XXX, que esté disponible en el anexo, de tal forma que Q5 se satura con \beta_{forzado} \approx 10 cuando la señan de RESET es igual a 5V. Utilizaremos el mismo valor elegido para YYY. (1pt)

## Plazo de entrega: 23:59, 31 de Marzo de 2025

## Anexo

Valores de Resistencias disponibles:

|   |  |        |       |  |
|------|------|-----------|------------|-------|
| 10Ω  | 220Ω | 1kΩ       | 6.8kΩ      | 100kΩ |
| 22Ω  | 270Ω | 2kΩ       | 10kΩ       | 220kΩ |
| 47Ω  | 330Ω | 2.2kΩ     | 20kΩ       | 300kΩ |
| 100Ω | 470Ω | 3.3kΩ     | 47kΩ       | 470kΩ |
| 150Ω | 510Ω | 4.7kΩ     | 51kΩ       | 680kΩ |
| 200Ω | 680Ω | 5.1kΩ     | 68kΩ       | 1M    |
