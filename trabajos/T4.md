# <img src="https://julianodb.github.io/SISTEMAS_ELECTRONICOS_PARA_INGENIERIA_BIOMEDICA/img/logo_fing.png?raw=true" align="right" height="45"> Trabajo 4 de Sistemas Electrónicos

#### Segundo Semestre de 2024

## Introducción

Este semestre, su grupo es responsable de diseñar y fabricar un prototipo de termometro médico electrónico para aplicar los conocimientos y tecnicas relacionados a la asignatura de Sistemas Electrónicos. 

El sistema que deben diseñar puede ser dividido en los siguientes bloques:

![TX](../img/TX.png)

Figura 1: División del sistema del termometro electrónico en bloques

En el cuarto trabajo, los objetivos son los siguientes:

1. corregir errores en los trabajos anteriores
1. diseñar las partes del circuito que utilizan comparadores
1. elegir una imagen para identificar las placas del grupo

El trabajo será un ensayo que debe contener la siguiente información:

- Identificación del grupo (color)
- Identificación de los integrantes del grupo (nombres, apellidos y RUT)
- La información que se pide en cada una de las siguientes sesiones de este documento

## 1. Correcciones de trabajos anteriores

1. Realicen todas las correcciones indicadas en los trabajos anteriores. Incluyan los calculos y derivación de los valores corregidos en este trabajo. La siguiente lista es un recordatorio de algunas de las correcciones pendientes. Sin embargo, si en algún trabajo se indica que algo debe corregirse y no está en la lista, incluyanlo también. Algunas de las correcciones se marcaron como opcionales en los respectivos trabajos. (3pt)

Grupo Blanco:
   - no hay correcciones pendientes, pueden saltarse ésta pregunta

Grupo Verde: 
   - identificar el circuito de driver de LED correcto
   - corregir valores de $R_{23}$, $R_{24}$, $R_{25}$, $R_{pot3}$ y $V_{REF}$
   - (opcional) disminuir $R_{12}$ para aumentar el brillo del LED. En el caso que lo hagan, ajusten también $R_{13}$ y $R_{14}$ para seguir cumpliendo con el requisito de saturación con $\beta_{forzado} \approx 10$

Grupo Rojo:
   - corregir valores de a, b, c y d en las ecuaciones que relacionan la temperatura medida por el sensor con los voltajes generados.
   - corregir valor de $R_{21}$

Grupo Amarillo:
   - identificar el circuito de driver de LED correcto
   - corregir valores de a, b, c y d en las ecuaciones que relacionan la temperatura medida por el sensor con los voltajes generados.
   - corregir valores de $R_{16}$, $C_5$, $R_{pot3}$ y $V_{REF}$

Grupo Azul:
   - corregir valores de $R_{22}$, $R_{23}$, $C_5$, $R_{pot2}$, $R_{pot3}$ y $V_{REF}$
   - (opcional) corregir valor de $R_{12}$ y $R_{14}$

## 2. Comparadores

En algunas partes del circuito del termometro se requiere un cambio de comportamiento cuando un voltaje sobrepasa un umbral. Por ejemplo, al medir la temperatura se requiere que el voltaje $V_A$ cambie de 0 V a 5 V dependiendo si la temperatura es mayor o menor que el umbral de temperatura alta. Se utilizará el componente LM393LVDR para cumplir con dicha funcionalidad. El LM393LVDR es un comparador, que es un tipo de amplificador operacional que está optimizado para trabajar saturado. Es decir, su salida es el voltaje maximo cuando $V_+ > V_-$, y el voltaje mínimo en caso contrario. 

2. Encuentren el datasheet del LM393LVDR e identifiquen su consumo de corriente cuando alimentado con 5 V. (0.5pt)

3. En el datasheet del LM393LVDR se dice que este tiene rail-to-rail input. ¿Qué significa rail-to-rail input ? (0.5pt)

   AYUDA: miren el Common-mode voltage range y comparenlo con el de otro comparador, como por ejemplo el LM2903D, cuyo input no es rail-to-rail .

La salida del comparador LM393LVDR es del tipo "open drain". Esto es equivalente a que en el pin de salida del chip se conecta el colector de un transistor NPN cuyo emisor está conectado a tierra*. Es decir, cuando el comparador tiene un resultado negativo ($V_+ < V_-$), el transistor se satura y conecta la salida a tierra. Por otro lado, si el resultado del comparador es positivo ($V_+ > V_-$), el transistor se corta y la salida queda "flotando". La intención es que el diseñador del circuito conecte una resistencia entre el pin de salida y el voltaje de alimentación positivo, de tal forma que si el transistor de salida se corta, el voltaje en el pin de salida sube a $V_{CC}$. La resistencia debe ser elegida para que la corriente que entra en el pin cuando el transistor está saturado sea menor que un cierto valor maximo especificado en el datasheet.

Afortunadamente cuando se diseñaron los circuitos de los drivers de los LEDs en el trabajo 2, los transistores $Q_A$ y $Q_B$ y sus respectivas resistencias $R_A$ y $R_B$, fueron elegidos de tal forma que representan exactamente la salida del LM393LVDR. Es decir, en el circuito del termometro no utilizaremos un transistor $Q_A$ y resistencia $R_A$, sino que los reemplazaremos por la salida de un comparador, y lo mismo con respecto a $Q_B$ y $R_B$. Las imagenes a continuación muestran los circuitos de driver de LEDs actualizados:

| Circuito A | Circuito B |
| -- | -- |
| <img src="https://julianodb.github.io/electronic_circuits_diagrams/T4_A.png" width="250"> | <img src="https://julianodb.github.io/electronic_circuits_diagrams/T4_B.png" width="250"> |

| Circuito C | Circuito D |
| -- | -- | 
| <img src="https://julianodb.github.io/electronic_circuits_diagrams/T4_C.png" width="300"> | <img src="https://julianodb.github.io/electronic_circuits_diagrams/T4_D.png" width="350"> |

| Circuito E | Circuito F |
| -- | -- | 
| <img src="https://julianodb.github.io/electronic_circuits_diagrams/T4_E.png" width="350"> | <img src="https://julianodb.github.io/electronic_circuits_diagrams/T4_F.png" width="350"> |

| Circuito G |
| -- |
|<img src="https://julianodb.github.io/electronic_circuits_diagrams/T4_G.png" width="400"> |

4. Determinen como conectar los potenciometros de ajuste de temperatura alta y temperatura baja y el voltaje que representa la temperatura medida ($V_{TEMP}$) a los comparadores en el circuito de su grupo para que se implemente la logica de encendido del LED deseada. A continuación se repiten las tablas que muestran cuando encender y apagar los LEDs dependiendo si la temperatura está alta o baja: (0.5pt)

### Grupo Verde

| temperatura | $V_A$ | $V_B$ | LED Verde |
| -- | -- | --| -- | 
| baja | 0 V | 0 V | apagado | 
| normal | 0 V | 5 V | encendido | 
| alta | 5 V | 5 V | apagado | 

### Grupo Blanco

| temperatura | $V_A$ | $V_B$ | LED Blanco |
| -- | -- | --| -- | 
| baja | 0 V | 5 V | apagado | 
| normal | 0 V | 0 V | encendido | 
| alta | 5 V | 0 V | apagado | 

### Grupo Rojo

| temperatura | $V_A$ | $V_B$ | LED Rojo |
| -- | -- | --| -- | 
| baja | 0 V | 5 V | encendido | 
| normal | 5 V | 5 V | apagado | 
| alta | 5 V | 0 V | encendido | 

### Grupo Amarillo

| temperatura | $V_A$ | $V_B$ | LED Amarillo |
| -- | -- | --| -- | 
| baja | 5 V | 5 V | encendido | 
| normal | 0 V | 5 V | apagado | 
| alta | 0 V | 0 V | encendido | 

### Grupo Azul

| temperatura | $V_A$ | $V_B$ | LED Azul |
| -- | -- | --| -- | 
| baja | 0 V | 0 V | encendido | 
| normal | 5 V | 0 V | apagado | 
| alta | 5 V | 5 V | encendido | 

\* estrictamente hablando el transistor de salida no es un transistor bipolar NPN, sino que es un MOSFET tipo n. Los MOSFETs tipo n son transistores que cumplen una función muy parecida a los NPN en los circuitos eléctricos. El pin del MOSFET equivalente al colector se llama dreno, o en inglés, *drain*, y de ahí el nombre open-drain.

5. Otra parte del circuito que requiere un comparador es el gatillo del buzzer. La idea es que cuando la derivada de $V_{TEMP}$ es menor que el umbral determinado por $R_{pot2}$, se cambia el voltaje de entrada del trigger de 0 a 5 V. Nuevamente, se utilizará un LM393LVDR para implementar dicha funcionalidad. Determinen en cual entrada del LM393LVDR se conecta la salida del $R_{pot2}$, y en cual se conecta el voltaje que representa la derivada de $V_{TEMP}$. (0.5pt)

6. Como discutido anterioremente, para que el comparador produzca 5 V en su salida es necesario conectar una resistencia a $V_{CC}$. 

- estable: donde va el pot y donde va la derivada
- R = 1/10 de R29 (antigua R13 del trigger)
(incluir imagen del trigger con nombres Rs)
(0.5pt)

- auto-off: donde va el VREF y donde va el otro
- resistencias para producir VREF =)
- salida va directo en V_ON del latch
(incluir imagen)
(0.5pt)

## 3. Imagen

7. Elijan una imagen para personalizar la placa que será fabricada con el circuito diseñado por su grupo. La imagen debe estar en el formato bitmap (.bmp), tener un tamaño mínimo de 2000 x 2000 y estar en blanco y negro. Envíenla al correo del profesor antes del plazo de entrega de este trabajo (0.5pt)

## Plazo de entrega: 23:59, 6 de Noviembre de 2024

## Anexo

I. Valores de Resistencias disponibles:

|   |  |        |       |  |
|------|------|-----------|------------|-------|
| 10Ω  | 220Ω | 1kΩ       | 6.8kΩ      | 100kΩ |
| 22Ω  | 270Ω | 2kΩ       | 10kΩ       | 220kΩ |
| 47Ω  | 330Ω | 2.2kΩ     | 20kΩ       | 300kΩ |
| 100Ω | 470Ω | 3.3kΩ     | 47kΩ       | 470kΩ |
| 150Ω | 510Ω | 4.7kΩ     | 51kΩ       | 680kΩ |
| 200Ω | 680Ω | 5.1kΩ     | 68kΩ       | 1M    |

II. Valores de Capacitores Ceramicos disponibles:

|   |  |        |       |  |
|------|------|-----------|------------|-------|
| 100 pF  | 220 pF | 330 pF | 470 pF | 680 pF |
| 1 nF  | 2.2 nF | 3.3 nF | 4.7 nF | 6.8 nF |
| 10 nF  | 22 nF | 33 nF | 47 nF | 68 nF |
| $0.1\ \mu F$  | $0.22\ \mu F$ | $0.33\ \mu F$| $0.47\ \mu F$ | $0.68\ \mu F$ |
| $1\ \mu F$  | - | - | $4.7\ \mu F$ | - |
| $10\ \mu F$  | $22\ \mu F$ | - | - | - |